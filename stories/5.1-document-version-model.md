# Story 5.1: Create DocumentVersion Model

## Metadata
- **Epic:** Epic 5 â€” Living Documentation System
- **Points:** 5
- **Priority:** High
- **Status:** ðŸ”² Not Started

## Description
Create a Prisma database model for storing document versions so that users can see how documentation evolved over time.

## User Story
*As a developer, I want to store version history so that users can see how documentation evolved.*

## Acceptance Criteria
- [ ] DocumentVersion model created in Prisma schema
- [ ] Stores full content snapshot per version
- [ ] Fields: pageId, version, content, createdBy, createdAt
- [ ] Fields: changeType (manual, auto, propagated), changeSource
- [ ] Diff from previous version computed and stored
- [ ] Efficient storage (consider delta compression for large docs)
- [ ] Query: list versions, get specific version, compare versions

## Technical Details

### Prisma Schema
```prisma
model DocumentVersion {
  id           String       @id @default(uuid())
  pageId       String       @map("page_id")
  tenantId     String       @map("tenant_id")
  version      Int
  content      Json         // Full TipTap content snapshot
  plainText    String       @map("plain_text")
  changeType   ChangeType
  changeSource String?      @map("change_source") // userId, machineId, or URL
  changeNotes  String?      @map("change_notes")
  diffFromPrev Json?        @map("diff_from_prev")
  createdAt    DateTime     @default(now()) @map("created_at")
  
  tenant       Tenant       @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  page         Page         @relation(fields: [pageId], references: [id], onDelete: Cascade)
  
  @@unique([pageId, version])
  @@index([pageId])
  @@index([tenantId, pageId])
  @@map("document_versions")
}

enum ChangeType {
  MANUAL
  AUTO_SYNC
  PROPAGATED
  MACHINE_UPDATE
  AI_SUGGESTED
}
```

## Dependencies
- Depends on: None
- Blocks: 5.2, 5.3, 5.4, 5.6

## Files to Create/Modify
- `prisma/schema.prisma`
- `prisma/migrations/YYYYMMDD_document_versions/`

## Testing
- Unit: Model creation
- Integration: Create/read versions

## Complexity
**M (Medium)** â€” Schema design with version tracking
